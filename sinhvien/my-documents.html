<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Qu·∫£n l√Ω t√†i li·ªáu c·ªßa t√¥i - DocShare">
    <title>T√†i li·ªáu c·ªßa t√¥i - DocShare</title>
    <link rel="stylesheet" href="../style.css">
    <link rel="icon" type="image/x-icon" href="../favicon.ico">
    <style>
        /* Additional Styles for My Documents */
        .filter-bar {
            background: white;
            padding: 20px 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .filter-label {
            font-weight: 600;
            color: #555;
            font-size: 0.9rem;
        }

        .filter-select {
            padding: 8px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            background: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .filter-select:hover,
        .filter-select:focus {
            border-color: #667eea;
            outline: none;
        }

        .search-input {
            flex: 1;
            min-width: 250px;
            padding: 10px 20px;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            font-size: 0.95rem;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .view-toggle {
            display: flex;
            gap: 5px;
            background: #f8f9fa;
            padding: 5px;
            border-radius: 8px;
        }

        .view-btn {
            padding: 8px 15px;
            border: none;
            background: transparent;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .view-btn.active {
            background: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .view-btn:hover {
            background: white;
        }

        .document-item {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .document-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
            border-color: #667eea;
        }

        .document-list-view {
            display: flex;
            padding: 20px;
            gap: 20px;
            align-items: center;
        }

        .document-thumbnail-small {
            width: 100px;
            height: 100px;
            border-radius: 8px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            flex-shrink: 0;
        }

        .document-info {
            flex: 1;
            min-width: 0;
        }

        .document-title-main {
            font-size: 1.2rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 8px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .document-meta-info {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 12px;
        }

        .document-meta-info span {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .document-description-text {
            color: #555;
            font-size: 0.9rem;
            line-height: 1.6;
            margin-bottom: 12px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .document-actions-bar {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .action-button {
            padding: 8px 16px;
            border-radius: 6px;
            border: none;
            font-weight: 600;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .action-button:hover {
            transform: translateY(-2px);
        }

        .btn-view-doc {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-view-doc:hover {
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .btn-edit {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
        }

        .btn-edit:hover {
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.4);
        }

        .btn-delete {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
        }

        .btn-delete:hover {
            box-shadow: 0 4px 12px rgba(231, 76, 60, 0.4);
        }

        .btn-share {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
            color: white;
        }

        .btn-share:hover {
            box-shadow: 0 4px 12px rgba(39, 174, 96, 0.4);
        }

        .document-status {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .status-approved {
            background: #d4edda;
            color: #155724;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-rejected {
            background: #f8d7da;
            color: #721c24;
        }

        .bulk-actions {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 15px 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: none;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .bulk-actions.show {
            display: flex;
        }

        .selected-count {
            font-weight: 700;
            color: #2c3e50;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin-top: 40px;
        }

        .pagination-btn {
            padding: 8px 16px;
            border: 2px solid #e9ecef;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .pagination-btn:hover:not(:disabled) {
            border-color: #667eea;
            color: #667eea;
            transform: translateY(-2px);
        }

        .pagination-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .stats-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-box {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .stat-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 800;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .empty-state-container {
            text-align: center;
            padding: 80px 20px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .empty-state-icon-big {
            font-size: 5rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state-title {
            font-size: 1.8rem;
            color: #2c3e50;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .empty-state-description {
            color: #666;
            font-size: 1.1rem;
            margin-bottom: 30px;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e9ecef;
        }

        .modal-title {
            font-size: 1.8rem;
            color: #2c3e50;
            font-weight: 700;
        }

        .modal-close {
            background: transparent;
            border: none;
            font-size: 2rem;
            color: #555;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: #f0f0f0;
            transform: rotate(90deg);
        }

        .checkbox-container {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        .checkbox-custom {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .filter-bar {
                flex-direction: column;
                align-items: stretch;
            }

            .filter-group {
                flex-direction: column;
                align-items: stretch;
            }

            .search-input {
                min-width: 100%;
            }

            .document-list-view {
                flex-direction: column;
            }

            .document-thumbnail-small {
                width: 100%;
                height: 150px;
            }

            .document-actions-bar {
                justify-content: stretch;
            }

            .action-button {
                flex: 1;
                justify-content: center;
            }

            .stats-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <p>ƒêang t·∫£i...</p>
    </div>

    <!-- Notification Toast -->
    <div id="notificationToast" class="notification-toast">
        <span id="toastMessage"></span>
        <button onclick="closeToast()" class="toast-close">&times;</button>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="logo">
                <a href="../index.html" style="text-decoration: none; color: inherit;">
                    <h1>üìö DocShare</h1>
                </a>
                <span class="logo-subtitle">H·ªçc t·∫≠p & Chia s·∫ª</span>
            </div>
            <nav class="nav">
                <a href="../index.html" class="nav-link">
                    <span class="nav-icon">üè†</span>
                    Trang ch·ªß
                </a>
                <a href="../documents/list.html" class="nav-link">
                    <span class="nav-icon">üîç</span>
                    Kh√°m ph√°
                </a>
                <a href="../features.html" class="nav-link">
                    <span class="nav-icon">‚ú®</span>
                    T√≠nh nƒÉng
                </a>
                <a href="../about.html" class="nav-link">
                    <span class="nav-icon">‚ÑπÔ∏è</span>
                    V·ªÅ ch√∫ng t√¥i
                </a>
                <div class="nav-buttons" id="authButtons" style="display: none;">
                    <a href="../login.html" class="btn-login">
                        <span>üîë</span> ƒêƒÉng nh·∫≠p
                    </a>
                    <a href="../register.html" class="btn-register">
                        <span>üìù</span> ƒêƒÉng k√Ω
                    </a>
                </div>
                <!-- User Dropdown (ch·ªâ hi·ªán khi ƒë√£ ƒëƒÉng nh·∫≠p) -->
                <div class="nav-buttons" id="userSection">
                    <a href="../admin/dashboard.html" id="adminLink" class="btn-danger" style="display: none;">
                        <span>üîë</span> Qu·∫£n tr·ªã
                    </a>
                    <div class="user-dropdown">
                        <button class="user-dropdown-btn" onclick="toggleUserDropdown()">
                            <span class="user-icon">üë§</span>
                            <span id="userNameHeader">Ng∆∞·ªùi d√πng</span>
                            <span class="dropdown-arrow">‚ñº</span>
                        </button>
                        <div class="user-dropdown-menu" id="userDropdownMenu">
                            <div class="dropdown-header">
                                <span class="user-icon">üë§</span>
                                <span id="dropdownUserEmail" style="margin-left: 8px;">email@example.com</span>
                            </div>
                            <div class="dropdown-content-grid">
                                <a href="./home.html" class="dropdown-item">
                                    <span class="dropdown-icon">üìä</span>
                                    <span>Dashboard</span>
                                </a>
                                <a href="./my-documents.html" class="dropdown-item">
                                    <span class="dropdown-icon">üìÑ</span>
                                    <span>T√†i li·ªáu c·ªßa t√¥i</span>
                                </a>
                                <a href="./upload.html" class="dropdown-item">
                                    <span class="dropdown-icon">‚¨ÜÔ∏è</span>
                                    <span>T·∫£i l√™n</span>
                                </a>
                                <a href="./profile.html" class="dropdown-item">
                                    <span class="dropdown-icon">‚öôÔ∏è</span>
                                    <span>C√†i ƒë·∫∑t</span>
                                </a>
                            </div>
                            <div class="dropdown-divider"></div>
                            <button onclick="logout()" class="dropdown-item dropdown-logout">
                                <span class="dropdown-icon">üö™</span>
                                <span>ƒêƒÉng xu·∫•t</span>
                            </button>
                        </div>
                    </div>
                </div>
            </nav>
            <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <section class="dashboard">
        <div class="container">
            <!-- Page Header -->
            <div class="dashboard-header">
                <div>
                    <h2>üìÑ T√†i li·ªáu c·ªßa t√¥i</h2>
                    <p style="opacity: 0.9; margin-top: 8px; font-size: 1.05rem;">Qu·∫£n l√Ω v√† theo d√µi t√†i li·ªáu ƒë√£ t·∫£i l√™n</p>
                </div>
                <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                    <a href="./upload.html" class="btn-cta-primary" style="padding: 12px 25px; font-size: 1rem;">
                        <span>‚¨ÜÔ∏è</span> T·∫£i t√†i li·ªáu m·ªõi
                    </a>
                    <button onclick="toggleBulkActions()" class="btn-cta-secondary" style="padding: 12px 25px; font-size: 1rem; background: rgba(255,255,255,0.2); border: 2px solid white;">
                        <span>‚òëÔ∏è</span> Ch·ªçn nhi·ªÅu
                    </button>
                </div>
            </div>

            <!-- Statistics Row -->
            <div class="stats-row">
                <div class="stat-box">
                    <div class="stat-icon">üìö</div>
                    <div class="stat-value" id="totalDocs">0</div>
                    <div class="stat-label">T·ªïng t√†i li·ªáu</div>
                </div>
                <div class="stat-box">
                    <div class="stat-icon">‚úÖ</div>
                    <div class="stat-value" id="approvedDocs">0</div>
                    <div class="stat-label">ƒê√£ duy·ªát</div>
                </div>
                <div class="stat-box">
                    <div class="stat-icon">‚è≥</div>
                    <div class="stat-value" id="pendingDocs">0</div>
                    <div class="stat-label">Ch·ªù duy·ªát</div>
                </div>
                <div class="stat-box">
                    <div class="stat-icon">üëÅÔ∏è</div>
                    <div class="stat-value" id="totalViews">0</div>
                    <div class="stat-label">T·ªïng l∆∞·ª£t xem</div>
                </div>
                <div class="stat-box">
                    <div class="stat-icon">‚¨áÔ∏è</div>
                    <div class="stat-value" id="totalDownloads">0</div>
                    <div class="stat-label">T·ªïng l∆∞·ª£t t·∫£i</div>
                </div>
            </div>

            <!-- Filter Bar -->
            <div class="filter-bar">
                <div class="filter-group">
                    <span class="filter-label">Tr·∫°ng th√°i:</span>
                    <select class="filter-select" id="statusFilter" onchange="filterDocuments()">
                        <option value="all">T·∫•t c·∫£</option>
                        <option value="approved">ƒê√£ duy·ªát</option>
                        <option value="pending">Ch·ªù duy·ªát</option>
                        <option value="rejected">T·ª´ ch·ªëi</option>
                    </select>
                </div>

                <div class="filter-group">
                    <span class="filter-label">Danh m·ª•c:</span>
                    <select class="filter-select" id="categoryFilter" onchange="filterDocuments()">
                        <option value="all">T·∫•t c·∫£</option>
                        <option value="tech">C√¥ng ngh·ªá</option>
                        <option value="science">Khoa h·ªçc</option>
                        <option value="business">Kinh t·∫ø</option>
                        <option value="language">Ng√¥n ng·ªØ</option>
                    </select>
                </div>

                <div class="filter-group">
                    <span class="filter-label">S·∫Øp x·∫øp:</span>
                    <select class="filter-select" id="sortFilter" onchange="sortDocuments()">
                        <option value="newest">M·ªõi nh·∫•t</option>
                        <option value="oldest">C≈© nh·∫•t</option>
                        <option value="views">L∆∞·ª£t xem</option>
                        <option value="downloads">L∆∞·ª£t t·∫£i</option>
                        <option value="rating">ƒê√°nh gi√°</option>
                    </select>
                </div>

                <input 
                    type="text" 
                    class="search-input" 
                    id="searchInput" 
                    placeholder="üîç T√¨m ki·∫øm t√†i li·ªáu..."
                    onkeyup="searchDocuments()"
                >

                <div class="view-toggle">
                    <button class="view-btn active" data-view="grid" onclick="changeView('grid')">
                        ‚äû
                    </button>
                    <button class="view-btn" data-view="list" onclick="changeView('list')">
                        ‚ò∞
                    </button>
                </div>
            </div>

            <!-- Bulk Actions Bar -->
            <div class="bulk-actions" id="bulkActionsBar">
                <span class="selected-count">
                    ƒê√£ ch·ªçn: <strong id="selectedCount">0</strong> t√†i li·ªáu
                </span>
                <button class="action-button btn-delete" onclick="bulkDelete()">
                    <span>üóëÔ∏è</span> X√≥a
                </button>
                <button class="action-button btn-edit" onclick="bulkChangeStatus()">
                    <span>‚úèÔ∏è</span> ƒê·ªïi tr·∫°ng th√°i
                </button>
                <button class="action-button" style="background: #95a5a6; color: white;" onclick="clearSelection()">
                    <span>‚úñÔ∏è</span> B·ªè ch·ªçn
                </button>
            </div>

            <!-- Documents Container -->
            <div id="documentsContainer" style="background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.07);">
                <div id="documentsList" class="docs-grid">
                    <!-- Documents will be loaded here -->
                    <div class="empty-state-container">
                        <div class="empty-state-icon-big">üì≠</div>
                        <h3 class="empty-state-title">Ch∆∞a c√≥ t√†i li·ªáu</h3>
                        <p class="empty-state-description">B·∫°n ch∆∞a t·∫£i l√™n t√†i li·ªáu n√†o</p>
                        <a href="./upload.html" class="btn" style="width: auto; display: inline-flex;">
                            <span>‚¨ÜÔ∏è</span> T·∫£i l√™n t√†i li·ªáu ƒë·∫ßu ti√™n
                        </a>
                    </div>
                </div>

                <!-- Pagination -->
                <div class="pagination" id="pagination" style="display: none;">
                    <button class="pagination-btn" onclick="goToPage(1)" id="firstPageBtn">
                        ‚Äπ‚Äπ
                    </button>
                    <button class="pagination-btn" onclick="previousPage()" id="prevPageBtn">
                        ‚Äπ
                    </button>
                    <span id="pageNumbers"></span>
                    <button class="pagination-btn" onclick="nextPage()" id="nextPageBtn">
                        ‚Ä∫
                    </button>
                    <button class="pagination-btn" onclick="goToLastPage()" id="lastPageBtn">
                        ‚Ä∫‚Ä∫
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Edit Modal -->
    <div class="modal-overlay" id="editModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">‚úèÔ∏è Ch·ªânh s·ª≠a t√†i li·ªáu</h3>
                <button class="modal-close" onclick="closeEditModal()">&times;</button>
            </div>
            <form id="editForm" onsubmit="saveEdit(event)">
                <input type="hidden" id="editDocId">
                <div class="form-group">
                    <label for="editTitle">Ti√™u ƒë·ªÅ</label>
                    <input type="text" id="editTitle" required>
                </div>
                <div class="form-group">
                    <label for="editDescription">M√¥ t·∫£</label>
                    <textarea id="editDescription" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label for="editCategory">Danh m·ª•c</label>
                    <select id="editCategory" required>
                        <option value="">Ch·ªçn danh m·ª•c</option>
                        <option value="tech">C√¥ng ngh·ªá</option>
                        <option value="science">Khoa h·ªçc</option>
                        <option value="business">Kinh t·∫ø</option>
                        <option value="language">Ng√¥n ng·ªØ</option>
                    </select>
                </div>
                <div style="display: flex; gap: 10px; margin-top: 25px;">
                    <button type="submit" class="btn" style="flex: 1;">
                        <span>üíæ</span> L∆∞u thay ƒë·ªïi
                    </button>
                    <button type="button" class="btn" style="flex: 1; background: #95a5a6;" onclick="closeEditModal()">
                        <span>‚úñÔ∏è</span> H·ªßy
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal-overlay" id="deleteModal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h3 class="modal-title">‚ö†Ô∏è X√°c nh·∫≠n x√≥a</h3>
                <button class="modal-close" onclick="closeDeleteModal()">&times;</button>
            </div>
            <div style="margin-bottom: 25px;">
                <p style="font-size: 1.1rem; color: #555; line-height: 1.6;">
                    B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a t√†i li·ªáu n√†y? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c.
                </p>
            </div>
            <div style="display: flex; gap: 10px;">
                <button class="btn btn-delete" style="flex: 1;" onclick="confirmDelete()">
                    <span>üóëÔ∏è</span> X√≥a
                </button>
                <button class="btn" style="flex: 1; background: #95a5a6;" onclick="closeDeleteModal()">
                    <span>‚úñÔ∏è</span> H·ªßy
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>üìö DocShare</h4>
                    <p>N·ªÅn t·∫£ng chia s·∫ª t√†i li·ªáu h·ªçc t·∫≠p h√†ng ƒë·∫ßu d√†nh cho sinh vi√™n Vi·ªát Nam</p>
                </div>
                <div class="footer-section">
                    <h4>Li√™n k·∫øt nhanh</h4>
                    <ul>
                        <li><a href="./home.html">Dashboard</a></li>
                        <li><a href="./my-documents.html">T√†i li·ªáu c·ªßa t√¥i</a></li>
                        <li><a href="./upload.html">T·∫£i l√™n</a></li>
                        <li><a href="./profile.html">C√†i ƒë·∫∑t</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>H·ªó tr·ª£</h4>
                    <ul>
                        <li><a href="../help.html">Tr·ª£ gi√∫p</a></li>
                        <li><a href="../contact.html">Li√™n h·ªá</a></li>
                        <li><a href="../faq.html">FAQ</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 DocShare. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Back to Top -->
    <button id="backToTop" class="back-to-top" onclick="scrollToTop()">‚Üë</button>

    <!-- Scripts -->
    <script src="../main.js"></script>
    <script src="../header-auth.js"></script>
    <script>
        // Global variables
        let allDocuments = [];
        let filteredDocuments = [];
        let currentPage = 1;
        let itemsPerPage = 12;
        let currentView = 'grid';
        let selectedDocuments = new Set();
        let bulkSelectMode = false;
        let documentToDelete = null;

        // Check authentication on page load
        window.addEventListener('DOMContentLoaded', function() {
            checkAuthAndLoadData();
        });

        // Check authentication and load data
        async function checkAuthAndLoadData() {
            const user = getUser();
            const token = getToken();

            if (!user || !token) {
                showToast('Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ ti·∫øp t·ª•c', 'info');
                setTimeout(() => {
                    window.location.href = '../login.html';
                }, 1500);
                return;
            }

            // Update user info
            updateUserInfo(user);

            // Load documents and stats
            await loadStatistics();
            await loadMyDocuments();
        }

        // Update user information
        function updateUserInfo(user) {
            const userNameHeader = document.getElementById('userNameHeader');
            const dropdownUserEmail = document.getElementById('dropdownUserEmail');

            if (userNameHeader) {
                const displayName = user.ho_ten || user.email.split('@')[0];
                userNameHeader.textContent = displayName.length > 20 ? displayName.substring(0, 20) + '...' : displayName;
            }

            if (dropdownUserEmail) {
                dropdownUserEmail.textContent = user.email;
            }
        }

        // Load statistics
        async function loadStatistics() {
            try {
                const response = await apiGet('/users/me/stats');
                
                if (response && response.ok) {
                    const stats = await response.json();
                    
                    // Map API response to document stats
                    const totalDocs = stats.documents || 0;
                    const totalViews = stats.views || 0;
                    const totalDownloads = stats.downloads || 0;
                    
                    // Calculate approved/pending from actual documents
                    const docsResponse = await apiGet('/documents/my-documents');
                    let approvedDocs = 0;
                    let pendingDocs = 0;
                    
                    if (docsResponse && docsResponse.ok) {
                        const docsData = await docsResponse.json();
                        const docs = docsData.documents || docsData || [];
                        approvedDocs = docs.filter(d => d.trang_thai === 'approved').length;
                        pendingDocs = docs.filter(d => d.trang_thai === 'pending').length;
                    }
                    
                    animateValue('totalDocs', 0, totalDocs, 1000);
                    animateValue('approvedDocs', 0, approvedDocs, 1000);
                    animateValue('pendingDocs', 0, pendingDocs, 1000);
                    animateValue('totalViews', 0, totalViews, 1000);
                    animateValue('totalDownloads', 0, totalDownloads, 1000);
                } else {
                    // Show 0 if error
                    animateValue('totalDocs', 0, 0, 1000);
                    animateValue('approvedDocs', 0, 0, 1000);
                    animateValue('pendingDocs', 0, 0, 1000);
                    animateValue('totalViews', 0, 0, 1000);
                    animateValue('totalDownloads', 0, 0, 1000);
                }
            } catch (error) {
                console.error('Error loading statistics:', error);
                // Show 0 if error
                animateValue('totalDocs', 0, 0, 1000);
                animateValue('approvedDocs', 0, 0, 1000);
                animateValue('pendingDocs', 0, 0, 1000);
                animateValue('totalViews', 0, 0, 1000);
                animateValue('totalDownloads', 0, 0, 1000);
            }
        }

        // Animate number count up
        function animateValue(id, start, end, duration) {
            const element = document.getElementById(id);
            if (!element) return;
            
            const range = end - start;
            const increment = range / (duration / 16);
            let current = start;
            
            const timer = setInterval(() => {
                current += increment;
                if ((increment > 0 && current >= end) || (increment < 0 && current <= end)) {
                    current = end;
                    clearInterval(timer);
                }
                element.textContent = Math.floor(current);
            }, 16);
        }

        // Load my documents
        async function loadMyDocuments() {
            showLoading();
            
            try {
                const response = await apiGet('/documents/my-documents');
                
                if (response && response.ok) {
                    const data = await response.json();
                    allDocuments = data.documents || data || [];
                    
                    if (allDocuments.length > 0) {
                        filteredDocuments = [...allDocuments];
                        displayDocuments();
                    } else {
                        showEmptyState();
                    }
                } else {
                    // Show empty state if error
                    allDocuments = [];
                    showEmptyState();
                }
            } catch (error) {
                console.error('Error loading documents:', error);
                // Show empty state if error
                allDocuments = [];
                showEmptyState();
            } finally {
                hideLoading();
            }
        }

        // Display documents
        function displayDocuments() {
            const container = document.getElementById('documentsList');
            const pagination = document.getElementById('pagination');
            
            if (!filteredDocuments || filteredDocuments.length === 0) {
                showEmptyState();
                pagination.style.display = 'none';
                return;
            }

            // Calculate pagination
            const totalPages = Math.ceil(filteredDocuments.length / itemsPerPage);
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = Math.min(startIndex + itemsPerPage, filteredDocuments.length);
            const documentsToShow = filteredDocuments.slice(startIndex, endIndex);

            // Display documents based on view mode
            if (currentView === 'grid') {
                container.className = 'docs-grid';
                container.innerHTML = documentsToShow.map(doc => createDocumentCardGrid(doc)).join('');
            } else {
                container.className = '';
                container.style.display = 'flex';
                container.style.flexDirection = 'column';
                container.style.gap = '15px';
                container.innerHTML = documentsToShow.map(doc => createDocumentCardList(doc)).join('');
            }

            // Show pagination
            if (totalPages > 1) {
                pagination.style.display = 'flex';
                updatePagination(totalPages);
            } else {
                pagination.style.display = 'none';
            }
        }

        // Create document card for grid view
        function createDocumentCardGrid(doc) {
            const colors = ['#667eea', '#27ae60', '#e74c3c', '#f39c12', '#3498db', '#9b59b6'];
            const randomColor = colors[Math.floor(Math.random() * colors.length)];
            const statusClass = `status-${doc.trang_thai || 'approved'}`;
            const statusText = {
                'approved': 'ƒê√£ duy·ªát',
                'pending': 'Ch·ªù duy·ªát',
                'rejected': 'T·ª´ ch·ªëi'
            };
            
            return `
                <div class="doc-card document-item">
                    ${bulkSelectMode ? `
                        <div style="padding: 15px;">
                            <label class="checkbox-container">
                                <input type="checkbox" class="checkbox-custom" onchange="toggleDocumentSelection(${doc.ma_tai_lieu})" ${selectedDocuments.has(doc.ma_tai_lieu) ? 'checked' : ''}>
                                <span>Ch·ªçn t√†i li·ªáu n√†y</span>
                            </label>
                        </div>
                    ` : ''}
                    <div class="doc-header">
                        <span class="doc-type">PDF</span>
                        <span class="document-status ${statusClass}">${statusText[doc.trang_thai] || 'ƒê√£ duy·ªát'}</span>
                    </div>
                    <div class="doc-thumbnail" style="background: linear-gradient(135deg, ${randomColor} 0%, ${randomColor}dd 100%);">
                        <div style="font-size: 3rem; color: white;">üìÑ</div>
                    </div>
                    <div class="doc-body">
                        <h4>${doc.tieu_de}</h4>
                        <p class="doc-description">${doc.mo_ta || 'Kh√¥ng c√≥ m√¥ t·∫£'}</p>
                        <div class="doc-info">
                            <span class="doc-date">üìÖ ${formatDate(doc.ngay_tai)}</span>
                        </div>
                        <div class="doc-stats">
                            <span title="L∆∞·ª£t xem">üëÅÔ∏è ${doc.so_luot_xem || 0}</span>
                            <span title="L∆∞·ª£t t·∫£i">‚¨áÔ∏è ${doc.so_luot_tai || 0}</span>
                            <span title="ƒê√°nh gi√°">‚≠ê ${doc.rating || '4.5'}</span>
                        </div>
                        <div class="doc-actions" style="margin-top: 15px;">
                            <button class="btn-view" onclick="viewDocument(${doc.ma_tai_lieu})" style="flex: 1;">
                                <span>üëÅÔ∏è</span> Xem
                            </button>
                            <button class="btn-download" onclick="editDocument(${doc.ma_tai_lieu})" style="flex: 1; background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);">
                                <span>‚úèÔ∏è</span> S·ª≠a
                            </button>
                        </div>
                        <button onclick="deleteDocument(${doc.ma_tai_lieu})" class="btn" style="width: 100%; margin-top: 10px; background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);">
                            <span>üóëÔ∏è</span> X√≥a
                        </button>
                    </div>
                </div>
            `;
        }

        // Create document card for list view
        function createDocumentCardList(doc) {
            const colors = ['#667eea', '#27ae60', '#e74c3c', '#f39c12', '#3498db', '#9b59b6'];
            const randomColor = colors[Math.floor(Math.random() * colors.length)];
            const statusClass = `status-${doc.trang_thai || 'approved'}`;
            const statusText = {
                'approved': 'ƒê√£ duy·ªát',
                'pending': 'Ch·ªù duy·ªát',
                'rejected': 'T·ª´ ch·ªëi'
            };
            
            return `
                <div class="document-item">
                    <div class="document-list-view">
                        ${bulkSelectMode ? `
                            <label class="checkbox-container">
                                <input type="checkbox" class="checkbox-custom" onchange="toggleDocumentSelection(${doc.ma_tai_lieu})" ${selectedDocuments.has(doc.ma_tai_lieu) ? 'checked' : ''}>
                            </label>
                        ` : ''}
                        <div class="document-thumbnail-small" style="background: linear-gradient(135deg, ${randomColor} 0%, ${randomColor}dd 100%);">
                            üìÑ
                        </div>
                        <div class="document-info">
                            <h3 class="document-title-main">${doc.tieu_de}</h3>
                            <div class="document-meta-info">
                                <span>üìÖ ${formatDate(doc.ngay_tai)}</span>
                                <span>üëÅÔ∏è ${doc.so_luot_xem || 0} l∆∞·ª£t xem</span>
                                <span>‚¨áÔ∏è ${doc.so_luot_tai || 0} l∆∞·ª£t t·∫£i</span>
                                <span>‚≠ê ${doc.rating || '4.5'}</span>
                                <span class="document-status ${statusClass}">${statusText[doc.trang_thai] || 'ƒê√£ duy·ªát'}</span>
                            </div>
                            <p class="document-description-text">${doc.mo_ta || 'Kh√¥ng c√≥ m√¥ t·∫£'}</p>
                            <div class="document-actions-bar">
                                <button class="action-button btn-view-doc" onclick="viewDocument(${doc.ma_tai_lieu})">
                                    <span>üëÅÔ∏è</span> Xem chi ti·∫øt
                                </button>
                                <button class="action-button btn-edit" onclick="editDocument(${doc.ma_tai_lieu})">
                                    <span>‚úèÔ∏è</span> Ch·ªânh s·ª≠a
                                </button>
                                <button class="action-button btn-share" onclick="shareDocument(${doc.ma_tai_lieu})">
                                    <span>üîó</span> Chia s·∫ª
                                </button>
                                <button class="action-button btn-delete" onclick="deleteDocument(${doc.ma_tai_lieu})">
                                    <span>üóëÔ∏è</span> X√≥a
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Show empty state
        function showEmptyState() {
            const container = document.getElementById('documentsList');
            container.innerHTML = `
                <div class="empty-state-container" style="grid-column: 1 / -1;">
                    <div class="empty-state-icon-big">üì≠</div>
                    <h3 class="empty-state-title">Ch∆∞a c√≥ t√†i li·ªáu</h3>
                    <p class="empty-state-description">B·∫°n ch∆∞a t·∫£i l√™n t√†i li·ªáu n√†o ho·∫∑c kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£ ph√π h·ª£p</p>
                    <a href="./upload.html" class="btn" style="width: auto; display: inline-flex;">
                        <span>‚¨ÜÔ∏è</span> T·∫£i l√™n t√†i li·ªáu
                    </a>
                </div>
            `;
        }

        // Filter documents
        function filterDocuments() {
            const statusFilter = document.getElementById('statusFilter').value;
            const categoryFilter = document.getElementById('categoryFilter').value;
            const searchQuery = document.getElementById('searchInput').value.toLowerCase();

            filteredDocuments = allDocuments.filter(doc => {
                const matchStatus = statusFilter === 'all' || doc.trang_thai === statusFilter;
                const matchCategory = categoryFilter === 'all' || doc.danh_muc === categoryFilter;
                const matchSearch = !searchQuery || 
                    doc.tieu_de.toLowerCase().includes(searchQuery) ||
                    (doc.mo_ta && doc.mo_ta.toLowerCase().includes(searchQuery));
                
                return matchStatus && matchCategory && matchSearch;
            });

            currentPage = 1;
            displayDocuments();
        }

        // Search documents
        function searchDocuments() {
            filterDocuments();
        }

        // Sort documents
        function sortDocuments() {
            const sortBy = document.getElementById('sortFilter').value;

            filteredDocuments.sort((a, b) => {
                switch(sortBy) {
                    case 'newest':
                        return new Date(b.ngay_tai) - new Date(a.ngay_tai);
                    case 'oldest':
                        return new Date(a.ngay_tai) - new Date(b.ngay_tai);
                    case 'views':
                        return (b.so_luot_xem || 0) - (a.so_luot_xem || 0);
                    case 'downloads':
                        return (b.so_luot_tai || 0) - (a.so_luot_tai || 0);
                    case 'rating':
                        return (b.rating || 0) - (a.rating || 0);
                    default:
                        return 0;
                }
            });

            displayDocuments();
        }

        // Change view mode
        function changeView(view) {
            currentView = view;
            
            // Update button states
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.view === view) {
                    btn.classList.add('active');
                }
            });

            displayDocuments();
        }

        // Pagination functions
        function updatePagination(totalPages) {
            const pageNumbers = document.getElementById('pageNumbers');
            let html = '';

            for (let i = 1; i <= totalPages; i++) {
                if (i === 1 || i === totalPages || (i >= currentPage - 2 && i <= currentPage + 2)) {
                    html += `<button class="pagination-btn ${i === currentPage ? 'active' : ''}" onclick="goToPage(${i})">${i}</button>`;
                } else if (i === currentPage - 3 || i === currentPage + 3) {
                    html += `<span style="padding: 0 5px;">...</span>`;
                }
            }

            pageNumbers.innerHTML = html;

            // Update button states
            document.getElementById('firstPageBtn').disabled = currentPage === 1;
            document.getElementById('prevPageBtn').disabled = currentPage === 1;
            document.getElementById('nextPageBtn').disabled = currentPage === totalPages;
            document.getElementById('lastPageBtn').disabled = currentPage === totalPages;
        }

        function goToPage(page) {
            currentPage = page;
            displayDocuments();
            scrollToTop();
        }

        function previousPage() {
            if (currentPage > 1) {
                currentPage--;
                displayDocuments();
                scrollToTop();
            }
        }

        function nextPage() {
            const totalPages = Math.ceil(filteredDocuments.length / itemsPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                displayDocuments();
                scrollToTop();
            }
        }

        function goToLastPage() {
            const totalPages = Math.ceil(filteredDocuments.length / itemsPerPage);
            currentPage = totalPages;
            displayDocuments();
            scrollToTop();
        }

        // Document actions
        function viewDocument(docId) {
            window.location.href = `../documents/detail.html?id=${docId}`;
        }

        function editDocument(docId) {
            const doc = allDocuments.find(d => d.ma_tai_lieu === docId);
            if (!doc) return;

            document.getElementById('editDocId').value = docId;
            document.getElementById('editTitle').value = doc.tieu_de;
            document.getElementById('editDescription').value = doc.mo_ta || '';
            document.getElementById('editCategory').value = doc.danh_muc || '';

            document.getElementById('editModal').classList.add('show');
        }

        function saveEdit(event) {
            event.preventDefault();
            
            const docId = document.getElementById('editDocId').value;
            const title = document.getElementById('editTitle').value;
            const description = document.getElementById('editDescription').value;
            const category = document.getElementById('editCategory').value;

            showLoading();

            // Simulate API call
            setTimeout(() => {
                hideLoading();
                closeEditModal();
                showToast('ƒê√£ l∆∞u thay ƒë·ªïi th√†nh c√¥ng', 'success');
                
                // Update document in array
                const doc = allDocuments.find(d => d.ma_tai_lieu == docId);
                if (doc) {
                    doc.tieu_de = title;
                    doc.mo_ta = description;
                    doc.danh_muc = category;
                    displayDocuments();
                }
            }, 1000);
        }

        function closeEditModal() {
            document.getElementById('editModal').classList.remove('show');
        }

        function deleteDocument(docId) {
            documentToDelete = docId;
            document.getElementById('deleteModal').classList.add('show');
        }

        function confirmDelete() {
            if (!documentToDelete) return;

            showLoading();
            closeDeleteModal();

            // Simulate API call
            setTimeout(() => {
                hideLoading();
                showToast('ƒê√£ x√≥a t√†i li·ªáu th√†nh c√¥ng', 'success');
                
                // Remove from array
                allDocuments = allDocuments.filter(d => d.ma_tai_lieu !== documentToDelete);
                filteredDocuments = filteredDocuments.filter(d => d.ma_tai_lieu !== documentToDelete);
                documentToDelete = null;
                
                displayDocuments();
                loadStatistics();
            }, 1000);
        }

        function closeDeleteModal() {
            document.getElementById('deleteModal').classList.remove('show');
            documentToDelete = null;
        }

        function shareDocument(docId) {
            const url = `${window.location.origin}/documents/detail.html?id=${docId}`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'Chia s·∫ª t√†i li·ªáu',
                    url: url
                }).catch(err => console.log('Share cancelled'));
            } else {
                copyToClipboard(url);
            }
        }

        // Bulk actions
        function toggleBulkActions() {
            bulkSelectMode = !bulkSelectMode;
            selectedDocuments.clear();
            
            const bulkBar = document.getElementById('bulkActionsBar');
            if (bulkSelectMode) {
                bulkBar.classList.add('show');
            } else {
                bulkBar.classList.remove('show');
            }
            
            displayDocuments();
            updateSelectedCount();
        }

        function toggleDocumentSelection(docId) {
            if (selectedDocuments.has(docId)) {
                selectedDocuments.delete(docId);
            } else {
                selectedDocuments.add(docId);
            }
            updateSelectedCount();
        }

        function updateSelectedCount() {
            document.getElementById('selectedCount').textContent = selectedDocuments.size;
        }

        function clearSelection() {
            selectedDocuments.clear();
            updateSelectedCount();
            displayDocuments();
        }

        function bulkDelete() {
            if (selectedDocuments.size === 0) {
                showToast('Vui l√≤ng ch·ªçn √≠t nh·∫•t m·ªôt t√†i li·ªáu', 'error');
                return;
            }

            if (confirm(`B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a ${selectedDocuments.size} t√†i li·ªáu ƒë√£ ch·ªçn?`)) {
                showLoading();
                
                setTimeout(() => {
                    hideLoading();
                    allDocuments = allDocuments.filter(d => !selectedDocuments.has(d.ma_tai_lieu));
                    filteredDocuments = filteredDocuments.filter(d => !selectedDocuments.has(d.ma_tai_lieu));
                    selectedDocuments.clear();
                    updateSelectedCount();
                    displayDocuments();
                    loadStatistics();
                    showToast('ƒê√£ x√≥a t√†i li·ªáu th√†nh c√¥ng', 'success');
                }, 1000);
            }
        }

        function bulkChangeStatus() {
            if (selectedDocuments.size === 0) {
                showToast('Vui l√≤ng ch·ªçn √≠t nh·∫•t m·ªôt t√†i li·ªáu', 'error');
                return;
            }

            const newStatus = prompt('Nh·∫≠p tr·∫°ng th√°i m·ªõi (approved/pending/rejected):');
            if (newStatus && ['approved', 'pending', 'rejected'].includes(newStatus)) {
                showLoading();
                
                setTimeout(() => {
                    hideLoading();
                    allDocuments.forEach(doc => {
                        if (selectedDocuments.has(doc.ma_tai_lieu)) {
                            doc.trang_thai = newStatus;
                        }
                    });
                    displayDocuments();
                    loadStatistics();
                    showToast('ƒê√£ c·∫≠p nh·∫≠t tr·∫°ng th√°i th√†nh c√¥ng', 'success');
                }, 1000);
            }
        }

        // Helper functions
        function formatDate(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffTime = Math.abs(now - date);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays === 0) return 'H√¥m nay';
            if (diffDays === 1) return 'H√¥m qua';
            if (diffDays < 7) return `${diffDays} ng√†y tr∆∞·ªõc`;
            if (diffDays < 30) return `${Math.floor(diffDays / 7)} tu·∫ßn tr∆∞·ªõc`;
            if (diffDays < 365) return `${Math.floor(diffDays / 30)} th√°ng tr∆∞·ªõc`;
            return date.toLocaleDateString('vi-VN');
        }

        function toggleUserDropdown() {
            const dropdown = document.getElementById('userDropdownMenu');
            if (dropdown) {
                dropdown.classList.toggle('show');
            }
        }

        function toggleMobileMenu() {
            const nav = document.querySelector('.nav');
            if (nav) {
                nav.classList.toggle('active');
            }
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            const dropdown = document.getElementById('userDropdownMenu');
            const dropdownBtn = document.querySelector('.user-dropdown-btn');
            
            if (dropdown && dropdownBtn) {
                if (!dropdown.contains(e.target) && !dropdownBtn.contains(e.target)) {
                    dropdown.classList.remove('show');
                }
            }
        });

        // Close modals on background click
        document.querySelectorAll('.modal-overlay').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('show');
                }
            });
        });
    </script>
</body>
</html>